

> @voice-agent-mastra-demo/shared@1.0.0 test /Users/jeanbapt/Library/Mobile Documents/com~apple~CloudDocs/Clients/SALESSCAN/voice-agent-mastra-demo/packages/shared
> vitest


[1m[7m[34m DEV [39m[27m[22m [34mv2.1.9 [39m[90m/Users/jeanbapt/Library/Mobile Documents/com~apple~CloudDocs/Clients/SALESSCAN/voice-agent-mastra-demo/packages/shared[39m

[?25l         [32mâœ“[39m should create ValidationError with message and issues
       [32mâœ“[39m SessionError[2m (2)[22m
         [32mâœ“[39m should create SessionError with message and optional sessionId
         [32mâœ“[39m should create SessionError without sessionId
       [32mâœ“[39m AgentError[2m (2)[22m
         [32mâœ“[39m should create AgentError with message and optional code
         [32mâœ“[39m should create AgentError without code
     [32mâœ“[39m Constants[2m (4)[22m
       [32mâœ“[39m should have correct default user preferences
       [32mâœ“[39m should have correct session timeout
       [32mâœ“[39m should have correct max message length
       [32mâœ“[39m should have correct max session messages
[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[G [32mâœ“[39m [2msrc/__tests__/[22mindex[2m.test.ts[22m[2m (39)[22m
   [32mâœ“[39m Shared Package[2m (39)[22m
     [32mâœ“[39m Utility Functions[2m (3)[22m
       [32mâœ“[39m generateId[2m (1)[22m
         [32mâœ“[39m should generate a unique string ID
       [32mâœ“[39m formatTimestamp[2m (1)[22m
         [32mâœ“[39m should format date to ISO string
       [32mâœ“[39m createTimestamp[2m (1)[22m
         [32mâœ“[39m should create a new Date object
     [32mâœ“[39m Validation Functions[2m (12)[22m
       [32mâœ“[39m validateVoiceMessage[2m (3)[22m
         [32mâœ“[39m should validate a valid voice message
         [32mâœ“[39m should throw ValidationError for invalid voice message
         [32mâœ“[39m should validate all mock voice messages
       [32mâœ“[39m validateAgentResponse[2m (3)[22m
         [32mâœ“[39m should validate a valid agent response
         [32mâœ“[39m should throw ValidationError for invalid agent response
         [32mâœ“[39m should validate all mock agent responses
       [32mâœ“[39m validateSession[2m (3)[22m
         [32mâœ“[39m should validate a valid session
         [32mâœ“[39m should throw ValidationError for invalid session
         [32mâœ“[39m should validate all mock sessions
       [32mâœ“[39m validateUser[2m (3)[22m
         [32mâœ“[39m should validate a valid user
         [32mâœ“[39m should throw ValidationError for invalid user
         [32mâœ“[39m should validate all mock users
     [32mâœ“[39m Type Guards[2m (9)[22m
       [32mâœ“[39m isVoiceMessage[2m (3)[22m
         [32mâœ“[39m should return true for valid voice message
         [32mâœ“[39m should return false for invalid voice message
         [32mâœ“[39m should return false for other types
       [32mâœ“[39m isAgentResponse[2m (3)[22m
         [32mâœ“[39m should return true for valid agent response
         [32mâœ“[39m should return false for invalid agent response
         [32mâœ“[39m should return false for other types
       [32mâœ“[39m isSession[2m (3)[22m
         [32mâœ“[39m should return true for valid session
         [32mâœ“[39m should return false for invalid session
         [32mâœ“[39m should return false for other types
     [32mâœ“[39m Safe Parse Functions[2m (6)[22m
       [32mâœ“[39m safeParseVoiceMessage[2m (2)[22m
         [32mâœ“[39m should return success for valid voice message
         [32mâœ“[39m should return error for invalid voice message
       [32mâœ“[39m safeParseAgentResponse[2m (2)[22m
         [32mâœ“[39m should return success for valid agent response
         [32mâœ“[39m should return error for invalid agent response
       [32mâœ“[39m safeParseSession[2m (2)[22m
         [32mâœ“[39m should return success for valid session
         [32mâœ“[39m should return error for invalid session
     [32mâœ“[39m Error Classes[2m (5)[22m
       [32mâœ“[39m ValidationError[2m (1)[22m
         [32mâœ“[39m should create ValidationError with message and issues
       [32mâœ“[39m SessionError[2m (2)[22m
         [32mâœ“[39m should create SessionError with message and optional sessionId
         [32mâœ“[39m should create SessionError without sessionId
       [32mâœ“[39m AgentError[2m (2)[22m
         [32mâœ“[39m should create AgentError with message and optional code
         [32mâœ“[39m should create AgentError without code
     [32mâœ“[39m Constants[2m (4)[22m
       [32mâœ“[39m should have correct default user preferences
       [32mâœ“[39m should have correct session timeout
       [32mâœ“[39m should have correct max message length
       [32mâœ“[39m should have correct max session messages

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m39 passed[39m[22m[90m (39)[39m
[2m   Start at [22m 07:30:04
[2m   Duration [22m 328ms[2m (transform 45ms, setup 0ms, collect 65ms, tests 12ms, environment 0ms, prepare 53ms)[22m

[1m[7m[32m PASS [39m[27m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[7m[34m RERUN [39m[27m[22m [34m[2msrc/__tests__/index.test.ts [22m[34mx1 [34m[39m

[?25l         [32mâœ“[39m should create ValidationError with message and issues
       [32mâœ“[39m SessionError[2m (2)[22m
         [32mâœ“[39m should create SessionError with message and optional sessionId
         [32mâœ“[39m should create SessionError without sessionId
       [32mâœ“[39m AgentError[2m (2)[22m
         [32mâœ“[39m should create AgentError with message and optional code
         [32mâœ“[39m should create AgentError without code
     [32mâœ“[39m Constants[2m (4)[22m
       [32mâœ“[39m should have correct default user preferences
       [32mâœ“[39m should have correct session timeout
       [32mâœ“[39m should have correct max message length
       [32mâœ“[39m should have correct max session messages
[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[G [32mâœ“[39m [2msrc/__tests__/[22mindex[2m.test.ts[22m[2m (39)[22m
   [32mâœ“[39m Shared Package[2m (39)[22m
     [32mâœ“[39m Utility Functions[2m (3)[22m
       [32mâœ“[39m generateId[2m (1)[22m
         [32mâœ“[39m should generate a unique string ID
       [32mâœ“[39m formatTimestamp[2m (1)[22m
         [32mâœ“[39m should format date to ISO string
       [32mâœ“[39m createTimestamp[2m (1)[22m
         [32mâœ“[39m should create a new Date object
     [32mâœ“[39m Validation Functions[2m (12)[22m
       [32mâœ“[39m validateVoiceMessage[2m (3)[22m
         [32mâœ“[39m should validate a valid voice message
         [32mâœ“[39m should throw ValidationError for invalid voice message
         [32mâœ“[39m should validate all mock voice messages
       [32mâœ“[39m validateAgentResponse[2m (3)[22m
         [32mâœ“[39m should validate a valid agent response
         [32mâœ“[39m should throw ValidationError for invalid agent response
         [32mâœ“[39m should validate all mock agent responses
       [32mâœ“[39m validateSession[2m (3)[22m
         [32mâœ“[39m should validate a valid session
         [32mâœ“[39m should throw ValidationError for invalid session
         [32mâœ“[39m should validate all mock sessions
       [32mâœ“[39m validateUser[2m (3)[22m
         [32mâœ“[39m should validate a valid user
         [32mâœ“[39m should throw ValidationError for invalid user
         [32mâœ“[39m should validate all mock users
     [32mâœ“[39m Type Guards[2m (9)[22m
       [32mâœ“[39m isVoiceMessage[2m (3)[22m
         [32mâœ“[39m should return true for valid voice message
         [32mâœ“[39m should return false for invalid voice message
         [32mâœ“[39m should return false for other types
       [32mâœ“[39m isAgentResponse[2m (3)[22m
         [32mâœ“[39m should return true for valid agent response
         [32mâœ“[39m should return false for invalid agent response
         [32mâœ“[39m should return false for other types
       [32mâœ“[39m isSession[2m (3)[22m
         [32mâœ“[39m should return true for valid session
         [32mâœ“[39m should return false for invalid session
         [32mâœ“[39m should return false for other types
     [32mâœ“[39m Safe Parse Functions[2m (6)[22m
       [32mâœ“[39m safeParseVoiceMessage[2m (2)[22m
         [32mâœ“[39m should return success for valid voice message
         [32mâœ“[39m should return error for invalid voice message
       [32mâœ“[39m safeParseAgentResponse[2m (2)[22m
         [32mâœ“[39m should return success for valid agent response
         [32mâœ“[39m should return error for invalid agent response
       [32mâœ“[39m safeParseSession[2m (2)[22m
         [32mâœ“[39m should return success for valid session
         [32mâœ“[39m should return error for invalid session
     [32mâœ“[39m Error Classes[2m (5)[22m
       [32mâœ“[39m ValidationError[2m (1)[22m
         [32mâœ“[39m should create ValidationError with message and issues
       [32mâœ“[39m SessionError[2m (2)[22m
         [32mâœ“[39m should create SessionError with message and optional sessionId
         [32mâœ“[39m should create SessionError without sessionId
       [32mâœ“[39m AgentError[2m (2)[22m
         [32mâœ“[39m should create AgentError with message and optional code
         [32mâœ“[39m should create AgentError without code
     [32mâœ“[39m Constants[2m (4)[22m
       [32mâœ“[39m should have correct default user preferences
       [32mâœ“[39m should have correct session timeout
       [32mâœ“[39m should have correct max message length
       [32mâœ“[39m should have correct max session messages

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m39 passed[39m[22m[90m (39)[39m
[2m   Start at [22m 07:34:18
[2m   Duration [22m 81ms

[1m[7m[32m PASS [39m[27m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[7m[34m RERUN [39m[27m[22m [34m[2msrc/index.ts [22m[34mx2 [34m[39m

[?25l         [90mÂ·[39m should create ValidationError with message and issues
       [90mÂ·[39m SessionError[2m (2)[22m
         [90mÂ·[39m should create SessionError with message and optional sessionId
         [90mÂ·[39m should create SessionError without sessionId
       [90mÂ·[39m AgentError[2m (2)[22m
         [90mÂ·[39m should create AgentError with message and optional code
         [90mÂ·[39m should create AgentError without code
     [90mÂ·[39m Constants[2m (4)[22m
       [90mÂ·[39m should have correct default user preferences
       [90mÂ·[39m should have correct session timeout
       [90mÂ·[39m should have correct max message length
       [90mÂ·[39m should have correct max session messages
[?25l[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[G         [32mâœ“[39m should create ValidationError with message and issues
       [32mâœ“[39m SessionError[2m (2)[22m
         [32mâœ“[39m should create SessionError with message and optional sessionId
         [32mâœ“[39m should create SessionError without sessionId
       [32mâœ“[39m AgentError[2m (2)[22m
         [32mâœ“[39m should create AgentError with message and optional code
         [32mâœ“[39m should create AgentError without code
     [32mâœ“[39m Constants[2m (4)[22m
       [32mâœ“[39m should have correct default user preferences
       [32mâœ“[39m should have correct session timeout
       [32mâœ“[39m should have correct max message length
       [32mâœ“[39m should have correct max session messages
[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[G [32mâœ“[39m [2msrc/__tests__/[22mindex[2m.test.ts[22m[2m (39)[22m
   [32mâœ“[39m Shared Package[2m (39)[22m
     [32mâœ“[39m Utility Functions[2m (3)[22m
       [32mâœ“[39m generateId[2m (1)[22m
         [32mâœ“[39m should generate a unique string ID
       [32mâœ“[39m formatTimestamp[2m (1)[22m
         [32mâœ“[39m should format date to ISO string
       [32mâœ“[39m createTimestamp[2m (1)[22m
         [32mâœ“[39m should create a new Date object
     [32mâœ“[39m Validation Functions[2m (12)[22m
       [32mâœ“[39m validateVoiceMessage[2m (3)[22m
         [32mâœ“[39m should validate a valid voice message
         [32mâœ“[39m should throw ValidationError for invalid voice message
         [32mâœ“[39m should validate all mock voice messages
       [32mâœ“[39m validateAgentResponse[2m (3)[22m
         [32mâœ“[39m should validate a valid agent response
         [32mâœ“[39m should throw ValidationError for invalid agent response
         [32mâœ“[39m should validate all mock agent responses
       [32mâœ“[39m validateSession[2m (3)[22m
         [32mâœ“[39m should validate a valid session
         [32mâœ“[39m should throw ValidationError for invalid session
         [32mâœ“[39m should validate all mock sessions
       [32mâœ“[39m validateUser[2m (3)[22m
         [32mâœ“[39m should validate a valid user
         [32mâœ“[39m should throw ValidationError for invalid user
         [32mâœ“[39m should validate all mock users
     [32mâœ“[39m Type Guards[2m (9)[22m
       [32mâœ“[39m isVoiceMessage[2m (3)[22m
         [32mâœ“[39m should return true for valid voice message
         [32mâœ“[39m should return false for invalid voice message
         [32mâœ“[39m should return false for other types
       [32mâœ“[39m isAgentResponse[2m (3)[22m
         [32mâœ“[39m should return true for valid agent response
         [32mâœ“[39m should return false for invalid agent response
         [32mâœ“[39m should return false for other types
       [32mâœ“[39m isSession[2m (3)[22m
         [32mâœ“[39m should return true for valid session
         [32mâœ“[39m should return false for invalid session
         [32mâœ“[39m should return false for other types
     [32mâœ“[39m Safe Parse Functions[2m (6)[22m
       [32mâœ“[39m safeParseVoiceMessage[2m (2)[22m
         [32mâœ“[39m should return success for valid voice message
         [32mâœ“[39m should return error for invalid voice message
       [32mâœ“[39m safeParseAgentResponse[2m (2)[22m
         [32mâœ“[39m should return success for valid agent response
         [32mâœ“[39m should return error for invalid agent response
       [32mâœ“[39m safeParseSession[2m (2)[22m
         [32mâœ“[39m should return success for valid session
         [32mâœ“[39m should return error for invalid session
     [32mâœ“[39m Error Classes[2m (5)[22m
       [32mâœ“[39m ValidationError[2m (1)[22m
         [32mâœ“[39m should cr